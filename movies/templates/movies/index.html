{% extends "base.html" %}

{% block content %}
    <h1 class="fw-bold" >MOVIE LIST</h1>

    <div class="g-2 row">
    {% for movie in movies %}
    <div class="col-12 col-md-6 col-xl-4">
      <div class="card">
        <div class="card-header d-flex justify-content-between">
          <div class="fs-5">
          {{ movie.title }}
          </div>
          
          {% comment %} 좋아요 구현 {% endcomment %}
          <div>
          <span>{{ movie.like_user.count }}</span>
          <form style="display:inline-block;" action="{% url "movies:likes" movie.pk %}" method="POST">
            {% csrf_token %}
            {% if request.user in movie.like_user.all %}
            <button class="btn btn-link text-danger"><i class="fa fa-heart" aria-hidden="true"></i></button>            
            {% else %}
            <button class="btn text-secondary"><i class="fa fa-heart" aria-hidden="true"></i></button>            
            {% endif %}
          </form>
          </div>
        </div>

        <div class="card-body">

          <div class="d-flex justify-content-center">
          {% if movie.image %}
          <a href="{% url "movies:detail" movie.pk %}">
          <img style="width: 300px; height: 400px;" src="{{ movie.image.url }}" alt="img">
          </a>
          {% endif %}
        </div>
        <div class="d-flex flex-row-reverse mt-2">
        <small>작성자: 
          <a href="{% url "accounts:profile" movie.user %}">{{ movie.user }}</a>
        </small>
        </div>
          <hr>

          <p class="card-text"> {{ movie.description }} </p>
          <hr>
          <div class="d-flex justify-content-between">
          <a href="{% url "movies:detail" movie.pk %}" class="btn btn-primary">상세정보</a>

          {% if request.user == movie.user %}
          <form style="display: inline;" action="{% url "movies:delete" movie.pk %}" method="POST">
            {% csrf_token %}
            <input type="submit" class="btn btn-danger" value="삭제">
          </form>
          {% endif %}
          </div>
    
        </div>
      </div>
      </div>
    {% endfor %}
  </div>

{% endblock content %}